---
title: "Datenaufbereitung"
author: "g3r!t"
date: "4 5 2021"
output: powerpoint_presentation
---
```{r}
install.packages("tidyverse")
```

```{r import libraries}
# Import needed libraries
library(ggplot2)
library(readr)
library(lubridate)
library(dplyr)
library(forcats)
```


```{r import and merge datasets}
# 1=Brot, 2=Broetchen, 3=Crossaint, 4=Konditorei, 5=Kuchen, 6=Saisonbrot
umsatzdaten <- read_csv("https://raw.githubusercontent.com/opencampus-sh/einfuehrung-in-data-science-und-ml/main/umsatzdaten_gekuerzt.csv")

kiwo <- read_csv("https://raw.githubusercontent.com/opencampus-sh/einfuehrung-in-data-science-und-ml/main/kiwo.csv")

# Convert ware group number into ware group name
Warengruppen <- c("Brot", "BrÃ¶tchen", "Crossaint", "Konditorei", "Kuchen", "Saisonbrot")
for (e in as.numeric(row.names(umsatzdaten)))
  umsatzdaten$Warengruppe[e] <- Warengruppen[as.numeric(umsatzdaten$Warengruppe[e])]
```


```{r import and merge datasets}
#URL weather codes https://www.seewetter-kiel.de/seewetter/daten_symbole.htm
#wind speed in knots[kn = sm/h = (km/h)/1.852]
wetterdaten <- read_csv("https://raw.githubusercontent.com/opencampus-sh/einfuehrung-in-data-science-und-ml/main/wetter.csv")
```


```{r import and change of column name}
#import weathercodes
wettercodes <- read_delim("https://raw.githubusercontent.com/g3r1t/EDSML-Projekt/main/Wettercodes.csv", 
    ";", escape_double = FALSE, trim_ws = TRUE)
# Change column-name of "Code" to "Wettercode"
colnames(wettercodes)[colnames(wettercodes) == "Code"] <- "Wettercode"
```


```{r merge datasets with leftjoin}
#leftjoin dataframes
UmsatzUndKiwo <- left_join(umsatzdaten, kiwo, by = "Datum")
AlleDatenBeisammen <- left_join(UmsatzUndKiwo, wetterdaten, by = "Datum")
```


```{r merge datasets with fulljoin}
#fulljoin dataframes
KiwoUndUmsatz <- full_join(umsatzdaten, kiwo, by = "Datum")
Alles <- full_join(KiwoUndUmsatz, wetterdaten, by = "Datum")
AllesUndWettercodes <- left_join(Alles, wettercodes, by = "Wettercode")
```